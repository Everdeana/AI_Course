<LangChain>

<라이브러리 설치>
d:\ai_exam\langchain_exam
- python 3.12
- 가상환경 : p312_nlp

<라이브러리 설치>
pip install langchain-community
pip install langchain-openai

pip install openai langchain

파일명 : langchain_start.py

맨처음 나오는 부분이 버젼문제
openai == 0.28

pip list
openai 1.33.1

<채팅>

langchain_chat.py
LangChain 0.0.10 and will be removed in 0.3.0
langchain-core 0.1.7 and will be removed in 0.3.0.
pip install 1.31. -> openai==0.28

[결과]: 대한민국의 수도는 서울특별시입니다. 서울은 대한민국의 정치, 경제, 문화의 중심지로서 국내외에서 가장 중요한 도시 중 하나로 인정
받고 있습니다. 서울은 또한 대한민국의 정부가 위치한 국회와 대통령청사가 있는 곳으로서 정치의 중심지이기도 합니다. 서울은 또한 국내외에
서 유명한 관광지와 문화예술의 중심지로서 많은 관광객들이 방문하는 도시입니다.

[결과]: 대한민국의 수도는 서울특별시입니다. 서울은 대한민국의 정치, 경제, 문화 중심지로서 국회, 대통령청사, 외교부, 중앙정부기관 등 중
요한 기관들이 모두 위치해 있습니다. 서울은 또한 국내외에서 유명한 관광지와 먹거리, 쇼핑지로 유명하며, 매년 수많은 관광객들이 방문합니 
다. 대한민국의 대표적인 도시이기도 합니다.

<랭체인 주요 사항>
llm = ChatOpenAI(
    temperature=0,   # 창의성(헛소리) 0.-2.
    max_tokens=2048, # 최대 토큰수
    model_name='gpt-3.5-turbo',
)

<템플릿 기능>
langchain_template.py

system
assistant
user

하만 넣은경우

사용자가 => "감기"
<가실만한 병원>
<좋은 처방약>
<감기에 좋은 음식>
<감기를 예방하는 방법>

array

pip install -U langchain-community

pip install openai==0.28
pip install langchain==0.2.0

=> RAG 엔진
RAG(Retrieval-Argumented Generation)
기존의 대규모 언어모델의 제한점을 해결하고자 나온
모델

RAG=langchain

<토큰 사용량 확인하는 방법>
LLMResult를 상세정보 보는 방법
=> 36토큰

gpt-3.5-turbo-0125	$0.0005 / 1K tokens
0.00069 * 18 = 0.01242

	$0.0015 / 1K tokens

0.00207 * 18 = 0.03726

= 0.4968

input 18
output 18

{'token_usage': {'completion_tokens': 70, 'prompt_tokens': 77, 'total_tokens': 147}, 'model_name': 'gpt-3.5-turbo'}

run=[RunInfo(run_id=UUID('22deba2a-295f-44e1-8c98-b7aa5caa750d')), RunInfo(run_id=UUID('9f7a1f41-bf67-40bf-8679-052037d1e049')), RunInfo(run_id=UUID('01329631-4605-4092-b952-4d944a6a4194')), RunInfo(run_id=UUID('bfb68345-3a5e-4e42-b5fc-515b7335811f')

ea1d51d9-1666-446a-a97b-6f9e79c576fd

<2개 이상의 변수를 조합해서 결과를 도출>
langchain_val.py

langchain + custom(pdf, txt, csv...) 
(*)=답변을 custom내용으로만 답변이 가능
=> hwp(x)

* chatgpt처럼 한자씩 나오도록 하고싶은경우
client-server <= stream 방식 구현

callback
프로세스가 동작이 되는동안 처리는되는 내용(상황)을
계속 보여주는 효과를 주기 위해서...
=> 비동기방식 구현
=> 멀티채팅을 구현

chat0001.txt
[영희]ㅇㄹㄴㄹㄴ
[철수]ㄴㄹㄴㄹ


abcd <= 판독
ocr -> abcdef

abcdef
ab1
ac1...

----------------------------------------------------------

허깅페이스(아주 유명한) **
custom 모델을 다운받아서 구동

pip install huggingface_hub transformers datasets

<LLM모델 모아놓은 곳>
https://huggingface.co/spaces/HuggingFaceH4/open_llm_leaderboard

langchain_hugging.py

Did not find huggingfacehub_api_token, please add an environment variable `HUGGINGFACEHUB_API_TOKEN` which contains it, or pass `huggingfacehub_api_token` as a named parameter.

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

Cannot access gated repo for url https://huggingface.co/api/models/mistralai/Mistral-7B-v0.1.
Access to model mistralai/Mistral-7B-v0.1 is restricted and you are not in the authorized list. Visit https://huggingface.co/mistralai/Mistral-7B-v0.1 to ask for access.

----------------------------------------------------------

채팅 구현하는 것
ConversationChain, Chat

langchain_convchat.py

나는 소년이다" 라는 뜻입니다. "I am a boy." 라는 문장은 자기 소개를 할 때 사용하는 문장으로, \'나는\'은 I, \'소년\'은 boy, \'이다\'는 am으로 해석됩니다.

죄송합니다. 그 증상은 다양한 원인이 있을 수 있습니다. 으실으실 떨림과 기침이 함께 나온다면 감기나 독감과 같은 호흡기 감염이 의심됩니다. 다른 증상이 있는지, 발열이 있는지, 가래의 
양과 색상은 어떤지 등 더 자세한 정보가 필요합니다. 식사나 수면은 정상인지, 최근에 외부 활동이나 접촉이 있었는지도 알려주세요. 이러한 정보들을 종합적으로 고려하여 증상의 원인을 더 정확히  
진단할 수 있습니다. 호흡기 감염의 가능성이 높으므로 안정적인 휴식과 수분 섭취, 적절한 약물 복용이 필요할 수 있습니다. 만약 증상이 악화되거나 다른 심각한 증상이 나타난다면 즉시 의료진 상담
을 받는 것이 중요합니다.

끝말잇기

요약하기(Summary) 처리 하는 방법

* 요약할 뉴스 내용 추천

langchain_summary.py

from langchain.prompts.chat import (
    ChatPromptTemplate,
    SystemMessagePromptTemplate,
    HumanMessagePromptTemplate,
)


"인공지능, 의사도 대체 가능...사회적 능력 계발 정책 변화 시급"

지난 10여년동안 의사소통 능력 등이 중요시되는 사회적 기술 일자리 비중이 증가하고, 이와 관련한 임금도 상승한 것으로 조사됐다. 또 인공지능(AI) 기술이 발달하면서 직업훈련과 교육 측면에서 사회적 능력을 계발할 수 있는 정책 변화가 시급하다는 의견도 나왔다. 

10일 한국은행은 오삼일 한은 조사국 고용분석팀장 등이 작성한 'BOK 이슈노트 : 노동시장에서 사회적 능력의 중요성 증가'를 발간하고, 이 같은 내용을 공개했다. 

보고서를 보면, 지난 2008~2022년 중 사회적 기술 집중 일자리 비중은 49%에서 56%로 7%포인트 상승했다. 반면 수학적(인지적) 기술 집중 일자리 비중은 50%에서 55%로 5%포인트 오르는데 그쳤다. 

오 팀장은 "전반적으로 우리나라 노동시장이 고숙련·고기술 일자리 중심으로 변화하는 가운데, 사회적 기술이 필요한 업무가 많은 일자리가 크게 늘었다"며 "지난 14년간 노동시장에서 수학적 기술보다는 사회적 기술의 중요성이 상대적으로 더 높아진 것"이라고 말했다.

사회적 능력에 대한 임금 보상도 늘었다. 개인의 사회적 능력이 1단위 높을 때 임금이 2007~2015년 중에는 4.4% 높고, 2016~2020년 중에는 5.9% 높은 것으로 추정됐다. 반면,인지적 능력이 1단위 높을 때는 임금이 2007~2015년 중 10.9% 높았지만, 2016~2020년 중에는 9.3% 높은 것으로 나타났다. 

의사도 인공지능 대체 가능성 높아져..."교육·직업훈련 정책 변화 시급"
 
오 팀장은 "최근 들어 사회적 능력에 대한 임금 보상은 과거보다 더 유의하게 높아진 반면 인지적 능력에 대한 임금 보상은 과거에 비해 낮아진 것"이라고 설명했다. 

사회적 능력의 중요성이 높아진 배경에는 인공지능의 발전이 있었다. 연구팀은 관련 문헌을 소개하면서 "병원에서 질병을 진단하고, 치료 계획을 세우는 등 기존에 고숙련 노동자가 수행하던 업무 또한 대체될 가능성이 높아졌다"며 "또한 고차원적 사고를 요구하는 고기술 업무 또한 정형화한 논리 구조를 가지기 때문에 컴퓨터에 의해 대체될 수 있다"고 밝혔다. 

이어 "직관, 판단력, 창의력, 유연성 등 인간의 암묵적인 지식은 명확하게 규칙화하기 어렵기 때문에 자동화 기술로 대체하기 어렵다"고 덧붙였다. 

연구팀은 앞으로 사회적 능력을 계발하는 것이 교육·직업훈련 측면에서 더욱 중요질 것으로 봤다. 오 팀장은 "자동화 기술의 대체 효과가 특정 직무나, 특정 일자리에 집중한다는 측면에서 개인의 자기계발에 대한 변화, 관련 정책의 변화가 시급하다고 판단한다"고 말했다. 

그러면서 "그렇지만 인지적 능력의 중요성을 간과하는 것은 아니다"라며 "최근 들어 전문 지식을 바탕으로 설득 능력이 있고, 매니지를 할 수 있는 사람과 관련 일자리가 가장 많이 늘어났기 때문에 인지 능력은 여전히 중요하다"고 했다. 

🤖 인공지능 기술 발전으로 의사소통 능력이 중요해지고 있어! 사회적 능력을 키우는 정책이 시급하대. 사회적 기술 일자리 비중이 늘어나고, 관련 임금도 상승 중이
래. 의사도 AI에게 대체될 수 있다는데, 교육과 직업훈련 정책 변화가 필요하다고 해! 사회적 능력과 인지적 능력 둘 다 중요하지만, 앞으로는 사회적 능력을 더욱 강
조할 필요가 있어. #사회적능력 #AI #교육정책 🧠🤝

최근에는 사람들끼리 대화하고 소통하는 능력이 중요해지고 있어. 그래서 이런 능력이 필요한 일자리도 많아지고 그에 따라 임금도 늘어나고 있어. 그리고 컴퓨터가 
똑똑해지면서 일부 직업은 컴퓨터가 할 수도 있게 되었어. 그래서 앞으로는 사람들이 소통하고 대화하는 능력을 키우는 것이 중요해질 거야. 하지만 여전히 숫자나 지
식을 잘 다루는 능력도 중요하니까 둘 다 중요하다고 할 수 있어.

LangChain -> RAG, WEB 불러와서 요약

* Local
<PDF 불러와서 채팅>
- PDF => VectorDB -> 저장
- Langchain -> VectorDB -> Chat 방식으로 구성
Map-Reduce

<웹개발 프레임워크>
- 초스피드로 제작
- gradio, streamlit

pip install gradio

http://localhost:7860

pip install pypdf
pip install chromadb

Failed building wheel for chroma-hnswlib
pip install chromadb==0.3.22
# pip install --upgrade pip
pip install chromadb

conda create -n p310_langchain python=3.10

pip install langchain

pip install -r requirements.txt
pip install -U langchain-community
pip install pypdf
pip install openai
pip install chromadb
pip install tiktoken
pip install gradio==3.50.2
http://localhost:9000












